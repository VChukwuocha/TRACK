<!DOCTYPE html>
<html>
  <head>
    <title>HOME</title>
    <link rel="stylesheet" href="/css/global.css" />
    <link rel="stylesheet" href="/css/createStudent.css" />
  </head>
  <body>
    <%- include("navbar")%>
    <section>
      <form action="/student/<%= student.id %>/student_edit/submit" method="post">
        <!-- Goal -->
        <h2>Edit <%= student.firstname %> <%= student.lastname %>'s Profile</h2>

        <input type="text" name="firstname" value="<%= student.firstname %>" placeholder="First Name" />
        <input type="text" name="lastname" value="<%= student.lastname %>" placeholder="Last Name" />
        <input type="text" name="studentemail" value="<%= student.email %>" placeholder="Email" />
        <input type="date" name="dob" id="dob" placeholder="Date of Birth" />

        <label for="Grade Level">Grade Level:</label>
          <select class="form-control" name="grade" id="grade" style="width:100%">
            <option value=""></option>
            <option value="Pre-K">Pre-K</option>
            <option value="Kindergarten">Kindergarten</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
          </select>
        <button type="submit" class="submit">Submit</button>
        <input type="hidden" name="userID" id="userID">
      </form>
    </section>    
  </body>
</html>

<script>
    //sorry this is a super jank way of getting user ID but its OKAY fix later maybe?
    document.getElementById("userID").value = localStorage.getItem("userID");
    console.log(localStorage.getItem("userID"));
    convertToYYYYMMDD("<%=student.dob%>");
    var grade = parseInt("<%= student.grade %>",10);
    console.log("grade: " + grade);
    if(grade == NaN) {
      document.getElementById("grade").selectedIndex = 2;
      console.log("is not number");
    } else {
      document.getElementById("grade").selectedIndex = parseInt("<%= student.grade %>",10)+1;
      console.log("is number?? confused");
    }
    document.getElementById("period").selectedIndex = "<%= student.period %>"-1;
  
    function convertToYYYYMMDD(d) {
      date = new Date(d);
      year = date.getFullYear();
      //console.log("Year: " + year);
      month = date.getMonth()+1;
      dt = date.getDate()+1;
  
      if (dt < 10) {
        dt = '0' + dt;
      }
      if (month < 10) {
        month = '0' + month;
      }
  
      if(year != NaN) {
        var format = String(year)+'-' + String(month) + '-'+String(dt);
      } else {
        var format = "";
      }
      console.log("formatted year: " + format);
      document.getElementById('dob').value = format;
    }
  </script>
